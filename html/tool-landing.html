<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Tool Landing Example</title>
    <link
      href="https://fonts.googleapis.com/css2?family=Fraunces:opsz,wght@9..144,600;9..144,700&family=Space+Grotesk:wght@400;500;600&display=swap"
      rel="stylesheet"
    />
    <link rel="stylesheet" href="./styles.css" />
  </head>
  <body>
    <div class="global-banner">
      Tool landing is not finished yet. Expect changes to the API and UI.
    </div>
    <main class="page">
      <section class="hero">
        <a class="back-link" href="./index.html">← Back to main page</a>
        <div class="eyebrow">Tool landing page</div>
        <h1>AlphaFold2</h1>
        <p class="lede">
          Protein structure prediction from a FASTA sequence (Galaxy Australia tool).
        </p>
        <div class="meta">
          <div>
            <span class="label">Tool ID</span>
            <span>toolshed.g2.bx.psu.edu/repos/galaxy-australia/alphafold2/alphafold/2.3.2+galaxy0</span>
          </div>
          <div>
            <span class="label">Version</span>
            <span>2.3.2+galaxy0</span>
          </div>
          <div>
            <span class="label">Example data</span>
            <a
              href="https://rest.uniprot.org/uniprotkb/P01308.fasta"
              target="_blank"
              rel="noreferrer"
              >rest.uniprot.org/uniprotkb/P01308.fasta</a
            >
          </div>
        </div>
        <div class="actions">
          <button id="run-tool" class="run-btn">Run tool in Galaxy</button>
          <a
            class="secondary"
            href="https://rest.uniprot.org/uniprotkb/P01308.fasta"
            target="_blank"
            rel="noreferrer"
            >View FASTA example</a
          >
        </div>
        <div id="tool-status" class="status" role="status" aria-live="polite"></div>
      </section>

      <section class="panel">
        <h2>How it works</h2>
        <div class="flow">
          <div class="flow-card">
            <span class="chip">1</span>
            <h3>Tool target</h3>
            <p>Point the landing request at the tool ID and version.</p>
            <pre class="code"><code>tool_id: "toolshed.g2.bx.psu.edu/.../alphafold/2.3.2+galaxy0"
tool_version: "2.3.2+galaxy0"</code></pre>
          </div>
          <div class="flow-card">
            <span class="chip">2</span>
            <h3>Request state</h3>
            <p>Prepopulate the sequence using the textbox input.</p>
            <pre class="code"><code>fasta_or_text: {
  input_mode: "textbox",
  fasta_text: "&gt;sp|P01308|INS_HUMAN ..."
}</code></pre>
          </div>
          <div class="flow-card">
            <span class="chip">3</span>
            <h3>Launch Galaxy</h3>
            <p>Redirect to the tool landing page with the UUID.</p>
            <pre class="code"><code>window.location = galaxy + "/tool_landings/" + uuid</code></pre>
          </div>
        </div>
      </section>

      <section class="panel note">
        <h2>Galaxy API</h2>
        <p class="lede">
          This demo posts to <code>/api/tool_landings</code> against
          <a href="https://usegalaxy.eu" target="_blank" rel="noreferrer"
            >usegalaxy.eu</a
          >
          without an API key.
        </p>
      </section>

      <section class="panel">
        <h2>UI note</h2>
        <p class="lede">
          On usegalaxy.eu, tool landing pages currently render a structured JSON view
          for generic tools (only the internal <code>__DATA_FETCH__</code> tool shows a
          custom UI). Seeing the request state JSON is expected and confirms the landing
          request worked.
        </p>
      </section>

      <section class="panel">
        <h2>Quick curl</h2>
        <div class="code-block">
          <button class="copy-btn" data-copy-target="tool-curl">Copy</button>
          <pre id="tool-curl" class="code"><code>curl -X POST "https://usegalaxy.eu/api/tool_landings" \
  -H "content-type: application/json" \
  -d '{"tool_id":"toolshed.g2.bx.psu.edu/repos/galaxy-australia/alphafold2/alphafold/2.3.2+galaxy0","tool_version":"2.3.2+galaxy0","request_state":{"fasta_or_text":{"input_mode":"textbox","fasta_text":">sp|P01308|INS_HUMAN ..."}},"public":true}'</code></pre>
        </div>
        <p class="lede">
          The response includes a <code>uuid</code>. Redirect users to
          <code>/tool_landings/&lt;uuid&gt;</code> on usegalaxy.eu.
        </p>
        <div class="code-block">
          <button class="copy-btn" data-copy-target="tool-next">Copy</button>
          <pre id="tool-next" class="code"><code># Example
https://usegalaxy.eu/tool_landings/32025b86-76ef-4480-b4c7-01255ada9d56</code></pre>
        </div>
      </section>

      <section class="panel">
        <h2>Schema references</h2>
        <p class="lede">
          <a href="https://usegalaxy.eu/api/docs" target="_blank" rel="noreferrer"
            >OpenAPI docs</a
          >
          ·
          <a href="https://usegalaxy.eu/openapi.json" target="_blank" rel="noreferrer"
            >openapi.json</a
          >
        </p>
      </section>
    </main>
    <script src="./app.js"></script>
  </body>
</html>
